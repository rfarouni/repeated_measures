ggplot(data = melted_cormat, aes(x=X1,value, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
corrplot(cor_mat, order = "hclust", tl.col='black', tl.cex=.5)
install.packages("corrplot")
library(corrplot)
corrplot(cor_mat, order = "hclust", tl.col='black', tl.cex=.5)
corrplot(cor_mat$rho, order = "hclust", tl.col='black', tl.cex=.5)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg2, columns = c(Extraversion, 52),
lower = list(
continuous = 'smooth',
discrete = 'ratio',
combo ='box'
),
upper = list(
continuous = 'density'
),
mapping = aes(color = Gender)
)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg2, columns = c(Extraversion, 52),
lower = list(
continuous = 'smooth',
combo ='box'
),
upper = list(
continuous = 'density'
),
mapping = aes(color = Gender)
)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg2, columns = Extraversion,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg, columns = Extraversion,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$Vote <- as.factor(bfg$Vote)
bfg$State < as.factor(bfg$State)
ggpairs(bfg, columns = 45:57,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$Vote <- as.factor(bfg$Vote)
bfg$State <- as.factor(bfg$State)
ggpairs(bfg, columns = 45:57,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
library(lavaan)
library(GGally)
library(ggplot2)
library(corrplot)
bfg <- read.table( "bfg_numeric.csv", sep = "\t", header = TRUE)
bfg$Vote <- as.factor(bfg$Vote)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$State <- as.factor(bfg$State)
library(GGally)
library(corrplot)
bfg <- read.table( "bfg_numeric.csv", sep = "\t", header = TRUE)
bfg$Vote <- as.factor(bfg$Vote)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$State <- as.factor(bfg$State)
library("dplyr")
library("tidyr")
library("ggplot2")
df_wide <- read.table("wells_addition_data.txt",
header = TRUE,
na.strings = ".")
df_wide
df_wide <- read.table("wells_addition_data.txt",
header = TRUE,
na.strings = ".")
df_wide
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- factor(period)
})
df_long
?gather
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
convert = TRUE,
3:6)
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
convert = TRUE,
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- factor(period)
})
df_long
colnames(df_wide)
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
convert = TRUE,
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- factor(period)
})
df_long
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
# id <- factor(id)
period <- as.integer(period)
})
df_long
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items") +
theme(legend.position = "none")
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items")
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items")
fit1 <- aov( score ~ period*sex + Error(id/period),
data = df_long)
summary(fit1)
library("dplyr")
library("tidyr")
library("ggplot2")
library("lme4")
demo1.aov <- lmer(score ~ period*sex +(1 |id), data = df_long)
coef(demo1.aov)
fixef(demo1.aov)
ranef(demo1.aov)
summary(demo1.aov)
print(demo1.aov )
Anova(demo1.aov,type="III")
demo1.aov <- lmer(score ~ period*sex +(1 |id), data = df_long)
coef(demo1.aov)
fixef(demo1.aov)
ranef(demo1.aov)
summary(demo1.aov)
print(demo1.aov )
anova(demo1.aov)
demo1.aov <- lmer(score ~ period*sex , data = df_long)
library("dplyr")
library("tidyr")
library("ggplot2")
library("nlme")
demo1.aov <- lme(score ~ period*sex +(1 |id), data = df_long)
demo1.aov <- lme(score ~ period+sex +(1 |id), data = df_long)
demo1.aov <- lme(score ~ period +(1 |id), data = df_long)
demo1.aov <- lme(score ~ period*sex, data = df_long)
demo1.aov <- lme(score ~ period, data = df_long)
wants <- c("car", "mvtnorm")
has   <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
set.seed(123)
P     <- 3
Nj    <- c(15, 25, 20)
Sigma <- matrix(c(16,-2, -2,9), byrow=TRUE, ncol=2)
mu11  <- c(-4,  4)
mu21  <- c( 3,  3)
mu31  <- c( 1, -1)
library(mvtnorm)
Y11 <- round(rmvnorm(Nj[1], mean=mu11, sigma=Sigma))
Y21 <- round(rmvnorm(Nj[2], mean=mu21, sigma=Sigma))
Y31 <- round(rmvnorm(Nj[3], mean=mu31, sigma=Sigma))
dfMan1 <- data.frame(Y =rbind(Y11, Y21, Y31),
IV=factor(rep(1:P, Nj)))
View(Sigma)
View(Y11)
View(Y21)
View(Y31)
View(dfMan1)
manRes1 <- manova(cbind(Y.1, Y.2) ~ IV, data=dfMan1)
summary(manRes1, test="Wilks")
fit3 <- gls(score~ period*sex,
data = df_long ,
correlation = corCompSymm(form = ~ 1 |id))
library("dplyr")
library("tidyr")
library("ggplot2")
library("nlme")
fit3 <- gls(score~ period*sex,
data = df_long ,
correlation = corCompSymm(form = ~ 1 |id))
(fit3)
fit3 <- gls(score~ period*sex,
data = df_long ,
correlation = corSymm(form = ~ 1 |id))
fit3 <- gls(score~ period*sex,
data = df_long ,
correlation = corSymm(form = ~ 1 |id))
summary(fit3)
fit3 <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id))
summary(fit3)
fit3 <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
method="ML")
summary(fit3)
getVarCov(fit3)
fit3 <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id))
summary(fit3)
getVarCov(fit3)
fit3 <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id))
summary(fit3)
getVarCov(fit3)
fm2 <- update(fit3, weights = varPower())
summary(fm2)
fit3 <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period))
summary(fit3)
getVarCov(fit3)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method= "REML")
summary(glsREML)
getVarCov(glsREML)
update(glsREML, method = "ML")
glsML <- update(glsREML, method = "ML")
summary(glsML)
getVarCov(glsML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML"
control = lmeControl(msMaxIter = 500, msVerbose = TRUE))
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML",
control = lmeControl(msMaxIter = 500, msVerbose = TRUE))
summary(glsREML)
getVarCov(glsREML)
glsML <- update(glsREML, method = "ML")
summary(glsML)
getVarCov(glsML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML",
control = lmeControl(msMaxIter = 500))
summary(glsREML)
getVarCov(glsREML)
glsML <- update(glsREML, method = "ML")
summary(glsML)
getVarCov(glsML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML",
control = lmeControl(msMaxIter = 1000))
summary(glsREML)
getVarCov(glsREML)
glsML <- update(glsREML, method = "ML")
summary(glsML)
getVarCov(glsML)
library("dplyr")
library("tidyr")
library("ggplot2")
library("nlme")
df_wide <- read.table("wells_addition_data.txt",
header = TRUE,
na.strings = ".")
df_wide
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items")
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
glsML <- update(glsREML, method = "ML")
summary(glsML)
getVarCov(glsML)
?getVarCov
library("dplyr")
library("tidyr")
library("ggplot2")
library("nlme")
df_wide <- read.table("wells_addition_data.txt",
header = TRUE,
na.strings = ".")
df_wide
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items")
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
glsML <- update(glsREML, method = "ML")
summary(glsML)
getVarCov(glsML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
library("dplyr")
library("tidyr")
library("ggplot2")
library("nlme")
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | id),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | id),
method = "REML")
summary(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |period),
weights = varIdent(form = ~ 1 | period),
method = "REML")
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
unlink('chap3/unit4_cache', recursive = TRUE)
library("data.table")
library("tidyr")
library("dplyr")
library("ggplot2")
library("nlme")
library("data.table")
library("dplyr")
"ggplot2"
library("ggplot2")
library("nlme")
library("tidyr")
library("data.table")
library("tidyr")
library("dplyr")
library("ggplot2")
library("nlme")
df_wide <- fread("hdrs.txt", na.strings = ".")
df_wide
