summary(glsML)
getVarCov(glsML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
library("dplyr")
library("tidyr")
library("ggplot2")
library("nlme")
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | id),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | id),
method = "REML")
summary(glsREML)
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |period),
weights = varIdent(form = ~ 1 | period),
method = "REML")
glsREML <- gls(score~ period,
data = df_long ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | period),
method = "REML")
summary(glsREML)
getVarCov(glsREML)
unlink('chap3/unit4_cache', recursive = TRUE)
library("data.table")
library("tidyr")
library("dplyr")
library("ggplot2")
library("nlme")
library("data.table")
library("dplyr")
"ggplot2"
library("ggplot2")
library("nlme")
library("tidyr")
library("data.table")
library("tidyr")
library("dplyr")
library("ggplot2")
library("nlme")
df_wide <- fread("hdrs.txt", na.strings = ".")
df_wide
library("data.table")
library("tidyr")
library("dplyr")
library("ggplot2")
library("nlme")
df_wide <- fread("hdrs.txt", na.strings = ".")
df_wide
?fread
library("data.table")
library("tidyr")
library("dplyr")
library("ggplot2")
library("nlme")
df_wide <- fread("hdrs.txt", na.strings = ".")
df_wide
colnames(df_wide) <- c("id",  "group", "0", "1", "2", "3", "4", "5")
df_long <- gather(data = df_wide ,
key = "week",
value = "score",
3:8)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
week <- as.integer(week)
})
df_long
ggplot(data = df_long, aes(x = week , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ group) +
xlab("Weeks") +
ylab("Rating") +
ggtitle(" Hamilton Depression Rating Scale scores")
df_long_filtered  <- na.omit(df_long)
df_long_filtered
glsREML <- gls(score ~ week + group + week*group,
data = df_long_filtered ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | week),
method = "REML")
summary(glsREML)
glsML <- update(glsREML, method = "ML")
summary(glsML)
skodak_wide <- fread("skodak.txt", na.strings = ".")
skodak_wide
skodak_long_filtered  <- skodak_long %>% na.omit() %>% arrange(id)
library("data.table")
library("tidyr")
library("dplyr")
library("ggplot2")
library("nlme")
df_wide <- fread("hdrs.txt", na.strings = ".")
df_wide
colnames(df_wide) <- c("id",  "group", "0", "1", "2", "3", "4", "5")
df_long <- gather(data = df_wide ,
key = "week",
value = "score",
3:8)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
week <- as.integer(week)
})
df_long
ggplot(data = df_long, aes(x = week , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ group) +
xlab("Weeks") +
ylab("Rating") +
ggtitle(" Hamilton Depression Rating Scale scores")
df_long_filtered  <- na.omit(df_long)
df_long_filtered
glsREML <- gls(score ~ week + group + week*group,
data = df_long_filtered ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | week),
method = "REML")
summary(glsREML)
glsML <- update(glsREML, method = "ML")
summary(glsML)
skodak_wide <- fread("skodak.txt", na.strings = ".")
skodak_wide
skodak_age <-
skodak_wide %>%
gather(key = "occasion",
value = "age",
3:6) %>%
select(- starts_with("iq"))
skodak_iq <-
skodak_wide %>%
gather(key = "occasion",
value = "iq",
7:10) %>%
select(-starts_with("age"))
skodak_long <- cbind(skodak_age, skodak_iq["iq"])
# change type of variables into factors
skodak_long <- within(skodak_long, {
id <- factor(id)
occasion <- factor(occasion)
})
#rename levels
levels(skodak_long$occasion) <- c("1", "2", "3", "4")
skodak_long_filtered  <- skodak_long %>% na.omit() %>% arrange(id)
skodak_long_filtered
glsREML <- gls(iq ~ age ,
data = skodak_long_filtered ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | occasion),
method = "REML")
summary(glsREML)
?reshape
skodak_age <-
skodak_wide %>%
gather(key = "occasion",
value = c("age", "iq"),
list(3:6, 7:10))
df2 <- reshape(skodak_wide,
direction = "long",
idvar = c("id", "gender"),
varying = list(c(3:6), c(7:10)),
v.names = c("age", "iq"),
times = c("1", "2", "3", "4"))
View(df2)
View(skodak_long)
View(df2)
skodak_long  <- reshape(skodak_wide,
direction = "long",
idvar = c("id", "gender"),
varying = list(c(3:6), c(7:10)),
v.names = c("age", "iq"),
occasion = c("1", "2", "3", "4"))
skodak_long  <- reshape(skodak_wide,
direction = "long",
idvar = c("id", "gender"),
varying = list(c(3:6), c(7:10)),
v.names = c("age", "iq"),
times = c("1", "2", "3", "4"))
skodak_long  <- reshape(skodak_wide,
direction = "long",
idvar = c("id", "gender"),
varying = list(c(3:6), c(7:10)),
v.names = c("age", "iq"),
times = c("1", "2", "3", "4"))
# change type of variables into factors
skodak_long <- within(skodak_long, {
id <- factor(id)
gender <- factor(gender)
time <- factor(time)
})
skodak_long  <- reshape(skodak_wide,
direction = "long",
idvar = c("id", "gender"),
varying = list(c(3:6), c(7:10)),
v.names = c("age", "iq"),
times = c("1", "2", "3", "4"))
# change type of variables into factors
skodak_long <- within(skodak_long, {
id <- factor(id)
gender <- factor(gender)
time <- factor(time)
})
skodak_long
skodak_long_filtered  <- skodak_long %>% na.omit() %>% arrange(id)
skodak_long_filtered
glsREML <- gls(iq ~ age ,
data = skodak_long_filtered ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | occasion),
method = "REML")
glsREML <- gls(iq ~ age ,
data = skodak_long_filtered ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | time),
method = "REML")
summary(glsREML)
glsREML <- gls(iq ~ age ,
data = skodak_long_filtered ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | time),
method = "ML")
summary(glsREML)
ggplot(data = df_long, aes(x = iq , y = age, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ gender) +
xlab("Weeks") +
ylab("Rating") +
ggtitle(" Hamilton Depression Rating Scale scores")
ggplot(data = skodak_long , aes(x = age , y = iq, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ gender) +
xlab("Weeks") +
ylab("Rating") +
ggtitle(" Hamilton Depression Rating Scale scores")
ggplot(data = skodak_long , aes(x = age , y = iq, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ gender) +
xlab("Age") +
ylab("IQ") +
ggtitle(" Skodak Iq Data") +
theme(legend.position="none")
ggplot(data = skodak_long , aes(x = age , y = iq, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ gender) +
xlab("Age") +
ylab("IQ") +
ggtitle(" Skodak Iq Data") +
theme(legend.position = "none")
ggplot(data = skodak_long_filtered , aes(x = age , y = iq, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ gender) +
xlab("Age") +
ylab("IQ") +
ggtitle(" Skodak Iq Data") +
theme(legend.position = "none")
glsREML <- gls(iq ~ age ,
data = skodak_long_filtered ,
correlation = corSymm(form = ~ 1 |id),
weights = varIdent(form = ~ 1 | time),
method = "ML")
summary(glsREML)
?paste
chromosomes <- c('chr1','chr2','chr3','chr4','chr5','chr6','chr7','chr8','chr9','chr10',
'chr11','chr12','chr13','chr14','chr15','chr16','chr17','chr18','chr19',
'chr20','chr21','chr22','chrX')
sprintf("GM12878_%s_binary.txt",chromosomes)
files <- file.path("/hd2/Spectacle/SAMPLEDATA_HG19/", sprintf("GM12878_%s_binary.txt",chromosomes))
files
temp <- lapply(files, fread, sep="\t")
library(data.table)
temp <- lapply(files, fread, sep="\t")
xx <-temp[1]
xx <-temp[[1]]
View(xx)
warnings()
data <- files %>% lapply(fread, sep="\t") %>% rbindlist()
library(magrittr)
data <- files %>% lapply(fread, sep="\t") %>% rbindlist()
View(data)
sums <- apply(data,1,sum)
dis< -table(sums)
dis <- table(sums)
dis
?table
dis <- table(sums)/length(sums)
xx <- cumsum(sums)
xx
xx_shift <- c(xx[-1],0)
xx_shift
dif <-xx-xx_shift
dif
xx_shift <- c(xx[-length(sums)],0)
dif <-xx-xx_shift
dif
length(sums)
xx_shift <- c(1, xx[-length(sums)])
dif <-xx-xx_shift
dif
xx_shift <- c(0, xx[-length(sums)])
dif <-xx-xx_shift
changepoints <-which(dif==1)
changepoints
changepoints_diff <-  changepoints- changepoints_shift
changepoints_shift <- c(0, changepoints[-length(changepoints)])
changepoints_diff <-  changepoints- changepoints_shift
changepoints_diff
hist(changepoints_diff)
hist(changepoints_diff, breaks=100)
hist(changepoints_diff, breaks=1000)
dis_zer<-table(changepoints_diff)
dis_zer
dis_zer<-t(table(changepoints_diff))
dis_zer
dis_zer[1000:1503]
dis_zer
dis_zer<-table(changepoints_diff)
dis_zer[1000:1503]
length(data)
dim(data)
dim(data)[1]
dim(data)[1]/100
ceiling(dim(data)[1]/100)
data[15181500:15181508,]
id <- rep(1:151815,10)
id
id <- rep(1:151815,rep(10,151815))
id
id <- rep(1:151815,rep(100,151815))
data_id <- cbind(data[-c(15181501:15181508)],id)
View(data_id)
data_id
data[c(15180001:15181508)]
data_id <- cbind(data[-c(15180001:15181508)],id)
id <- rep(1:151800,rep(100,151800))
data_id <- cbind(data[-c(15180001:15181508)],id)
data_id
library(dpylr)
library(dplyr)
install.packages("dtplyr")
xx <- data_id %>% group_by(id)
xxx <-xx[1:10,]
xxx
xxx <- c(xx[1:10,])
xxx
xxx <- unlist(c(xx[1:10,]))
xxx
xxx <- as.matrix(x[1:10,])
xxx <- as.matrix(xx[1:10,])
xxx
xxx
c(xxx)
c(t(xxx))
xx <- data_id %>% group_by(id) %>% as.matrix()  %>% t()  %>% c()
xx <- data_id %>% group_by(id)  %>%  c(t(as.matrix(.)) %>% rbind
xx <- data_id %>% group_by(id)  %>%  c(t(as.matrix(.))) %>% rbind
xx <- data_id %>% group_by(id)  %>%  c(t(as.matrix(.)))
xx
?combine
xx <- data_id %>% group_by(id)  %>%  combine()
chromosomes <- c('chr1','chr2','chr3','chr4','chr5','chr6','chr7','chr8','chr9','chr10',
'chr11','chr12','chr13','chr14','chr15','chr16','chr17','chr18','chr19',
'chr20','chr21','chr22','chrX')
files <- file.path("/hd2/Spectacle/SAMPLEDATA_HG19/",
sprintf("GM12878_%s_binary.txt",
chromosomes))
library(dtplyr)
data <- files %>% lapply(fread, sep="\t") %>% bind_rows()
id <- rep(1:151800,rep(100,151800))
data_id <- cbind(data[-c(15180001:15181508)],id)
?fread
data <- files %>% lapply(fread, sep="\t") %>% bind_rows()
id <- rep(1:151800,rep(100,151800))
data_id <- cbind(data[-c(15180001:15181508)],id)
xx <- data_id %>% group_by(id)  %>%  combine()
dim(xx) <- c(151800,900)
View(xx)
xx <- data_id %>% group_by(id)  %>% t()  %>%  combine()
dim(xx) <- c(151800,900)
View(xx)
xx <- data_id  %>%  combine()
dim(xx) <- c(151800,900)
View(xx)
xx <- data_id  %>%  t() %>%  combine()
dim(xx) <- c(151800,900)
View(xx)
xx <- data_id %>% group_by(id)  %>% bind_rows() %>%  combine()
xx <- data_id %>% group_by(id)  %>%   combine()
xx
151800*900
xx <- data_id %>% group_by(id)  %>%   t() %>% combine()
xx
dim(xx) <- c(151800,900)
View(xx)
xx <- data_id %>% group_by(id)  %>%   t() %>% combine()
dim(xx) <- c(900, 151800)
View(xx)
xx <- t(xx)
View(xx)
xx <- data_id   %>%   t() %>% combine()
dim(xx) <- c(900, 151800)
xx <- t(xx)
View(xx)
?dim
data <- data[-c(15180001:15181508)]
xx <- data_id   %>%   t() %>% combine()
dim(xx) <- c(800, 151800)
xx <- t(xx)
xx <- data_id   %>%   t() %>% combine()
dim(xx) <- c(900, 151800)
xx <- t(xx)
xx
id <- rep(1:151800,rep(100,151800))
data_id <- cbind(data[-c(15180001:15181508)],id)
xx <- data_id   %>%   t() %>% combine()
dim(xx) <- c(900, 151800)
xx <- t(xx)
View(xx)
c(9*(1:100))
xx<- xx[, -c(9*(1:100))]
sums <- apply(xx,1,sum)
dis <- table(sums)/length(sums)
dis
dis <- table(sums)
dis
sums
sums
ind <-which(sums==0)
ind
df <- xx[-ind,]
df
id <- rep(1:151815,rep(100,151815))
data_id <- cbind(data[-c(15181501:15181508)],id)
xx <- data_id   %>%   t() %>% combine()
dim(xx) <- c(900, 151800)
xx <- t(xx)
xx <- xx[, -c(9*(1:100))]
sums <- apply(xx,1,sum)
ind <-which(sums==0)
df <- xx[-ind,]
data <- files %>% lapply(fread, sep="\t") %>% bind_rows()
id <- rep(1:151815,rep(100,151815))
data_id <- cbind(data[-c(15181501:15181508)],id)
xx <- data_id   %>%   t() %>% combine()
dim(xx) <- c(900, 151815)
xx <- t(xx)
xx <- xx[, -c(9*(1:100))]
sums <- apply(xx,1,sum)
ind <-which(sums==0)
df <- xx[-ind,]
View(df)
sum(df)
xx <- data_id   %>% group_by(id) %>% t() %>% combine()
dim(xx) <- c(900, 151815)
xx <- t(xx)
xx <- xx[, -c(9*(1:100))]
sums <- apply(xx,1,sum)
ind <-which(sums==0)
df <- xx[-ind,]
sum(df)
View(xx)
data_id
sums <- apply(data,1,sum)
ind <-which(sums==0)
df2 <- data[-ind,]
df2
chromosomes <- c('chr1','chr2','chr3','chr4','chr5','chr6','chr7','chr8','chr9','chr10',
'chr11','chr12','chr13','chr14','chr15','chr16','chr17','chr18','chr19',
'chr20','chr21','chr22','chrX')
GM12878 <- file.path("/hd2/Spectacle/sample_data/",
sprintf("GM12878_%s_binary.txt",
chromosomes))
K562 <- file.path("/hd2/Spectacle/sample_data/",
sprintf("K562_%s_binary.txt",
chromosomes))
GM12878data <- GM12878 %>% lapply(fread, sep="\t") %>% bind_rows()
K562data <- K562 %>% lapply(fread, sep="\t") %>% bind_rows()
data <- bind_cols(GM12878data,K562data )
View(data)
?gls
id <- rep(1:151815,rep(100,151815))
data_id <- cbind(data[-c(15181501:15181508)],id)
xx <- data_id   %>% group_by(id) %>% t() %>% combine()
sums <- apply(data,1,sum)
xx <- cumsum(sums)
ind <-which(sums==0)
df2 <- data[-ind,]
