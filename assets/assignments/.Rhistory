))
ggpairs(bfg2, columns = Extraversion,
lower = list(
continuous = 'smooth',
discrete= 'ratio'
),
upper = list(
continuous = 'density'
))
bfg <- read.table( "bfg_numeric.csv", sep = "\t", header = TRUE)
bfg2 <- read.table( "bfg.csv", sep = "\t", header = TRUE)
head(bfg)
ind <- c(2,6,21,31,12,27,37,8,18,23,43,9,24,34,35,41)
keys <- rep(1,44)
keys[ind] <- -1
bfg[,1:44] <- as.data.frame(psych::reverse.code(keys, bfg[,1:44] , mini = 1, maxi = 5))
head(bfg)
ord <- c(1, 6, 11, 16, 21, 26, 31, 36,
2, 7, 12, 17, 22, 27, 32, 37, 42,
3, 8, 13, 18, 23, 28, 33, 38, 43,
4, 9, 14, 19, 24, 29, 34, 39,
5, 10, 15, 20, 25, 30, 35, 40, 41, 44)
bfg <- bfg[ ,c(ord,45:57)]
head(bfg)
bfg2 <-  bfg[]
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg2, columns = Extraversion,
lower = list(
continuous = 'smooth',
discrete= 'ratio'
),
upper = list(
continuous = 'density'
))
ggpairs(bfg2, columns = c(Extraversion, 51),
lower = list(
continuous = 'smooth',
discrete= 'ratio'
),
upper = list(
continuous = 'density'
))
ggpairs(bfg2, columns = c(Extraversion, 52),
lower = list(
continuous = 'smooth',
discrete= 'ratio'
),
upper = list(
continuous = 'density'
))
bfg2 <- read.table( "bfg.csv", sep = "\t", header = TRUE)
head(bfg)
ind <- c(2,6,21,31,12,27,37,8,18,23,43,9,24,34,35,41)
keys <- rep(1,44)
keys[ind] <- -1
bfg2[,1:44] <- as.data.frame(psych::reverse.code(keys, bfg2[,1:44] , mini = 1, maxi = 5))
levels(bfg2)
levels(bfg2)
levels(bfg2$1bfi_1)
levels(bfg2$bfi_1)
rev(levels(bfg2$bfi_1))
install.packages("polycor")
polycor::polychor(bfg2[,1:2])
polycor::polychor(bfg[,1:2])
polycor::polychor(bfg[,1:3])
polycor::polychor(bfg$bfi_1,bfg$bfi_6)
psych::polychoric(bfg[,1:44])
melted_cormat <- reshape::melt(psych::polychoric(bfg[,1:44]))
melted_cormat <-  reshape::melt(cor_mat)
cor_mat <- psych::polychoric(bfg[,1:44]))
cor_mat <- psych::polychoric(bfg[,1:44])
melted_cormat <-  reshape::melt(cor_mat)
melted_cormat <-  reshape::melt(cor_mat$rho)
ggplot(data = melted_cormat, aes(x=Var1, y=Var2, fill=value)) +
geom_tile()
ggplot(data = melted_cormat, aes(x=X1, y=X2, fill=value)) +
geom_tile()
ggplot(data = melted_cormat, aes(x=X1, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
melted_cormat
View(melted_cormat)
ggplot(data = melted_cormat, aes(x=X1, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
cormat <- psych::polychoric(bfg[,1:44])
get_upper_tri <- function(cormat){
cormat[lower.tri(cormat)]<- NA
return(cormat)}
cormat <- reorder_cormat(cormat)
reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}
cormat <- reorder_cormat(cormat)
cor_mat <- psych::polychoric(bfg[,1:44])
melted_cormat <-  reshape::melt(cor_mat$rho)
ggplot(data = melted_cormat, aes(x=X1, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
View(melted_cormat)
ggplot(data = order_by(X1,melted_cormat), aes(x=X1, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
ggplot(data = reorder(melted_cormat,X1), aes(x=X1, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
ggplot(data = melted_cormat, aes(x=reorder(X1), y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
ggplot(data = melted_cormat, aes(x=reorder(X1,X2), y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
ggplot(data = melted_cormat, aes(x=reorder(X1,value), y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
View(melted_cormat)
levels(melted_cormat$X1)
order(levels(melted_cormat$X1))
names(X1)
names(melted_cormat$X1)
melted_cormat$X1
Relevel(melted_cormat$X1,melted_cormat$X1[1:44])
install.packages("Epi")
Epi::Relevel(melted_cormat$X1,melted_cormat$X1[1:44])
relevel(melted_cormat$X1,melted_cormat$X1[1:44])
?relevel
View(melted_cormat)
levels(melted_cormat$X1) <- melted_cormat$X1[1:44]
levels(melted_cormat$X2) <- melted_cormat$X1[1:44]
ggplot(data = melted_cormat, aes(x=X1,value, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
cor_mat <- psych::polychoric(bfg[,1:44])
melted_cormat <-  reshape::melt(cor_mat$rho)
levels(melted_cormat$X1) <- melted_cormat$X1[1:44]
melted_cormat <-  reshape::melt(cor_mat$rho)
new_labels <- melted_cormat$X1[1:44]
levels(melted_cormat$X1) <- new_labels
levels(melted_cormat$X2) <- new_labels
ggplot(data = melted_cormat, aes(x=X1,value, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
cor_mat$rho
library(lavaan)
library(GGally)
library(ggplot2)
bfg <- read.table( "bfg_numeric.csv", sep = "\t", header = TRUE)
sizes <- factor(sizes, levels=rev(levels(bfg2)))
bfg <- read.table( "bfg_numeric.csv", sep = "\t", header = TRUE)
ind <- c(2,6,21,31,12,27,37,8,18,23,43,9,24,34,35,41)
keys <- rep(1,44)
keys[ind] <- -1
bfg[,1:44] <- as.data.frame(psych::reverse.code(keys, bfg[,1:44] , mini = 1, maxi = 5))
head(bfg)
ord <- c(1, 6, 11, 16, 21, 26, 31, 36,
2, 7, 12, 17, 22, 27, 32, 37, 42,
3, 8, 13, 18, 23, 28, 33, 38, 43,
4, 9, 14, 19, 24, 29, 34, 39,
5, 10, 15, 20, 25, 30, 35, 40, 41, 44)
bfg <- bfg[ ,c(ord,45:57)]
head(bfg)
cor_mat <- psych::polychoric(bfg[,1:44])
melted_cormat <-  reshape::melt(cor_mat$rho)
new_labels <- melted_cormat$X1[1:44]
levels(melted_cormat$X1) <- new_labels
levels(melted_cormat$X2) <- new_labels
ggplot(data = melted_cormat, aes(x=X1,value, y=X2, fill=value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
corrplot(cor_mat, order = "hclust", tl.col='black', tl.cex=.5)
install.packages("corrplot")
library(corrplot)
corrplot(cor_mat, order = "hclust", tl.col='black', tl.cex=.5)
corrplot(cor_mat$rho, order = "hclust", tl.col='black', tl.cex=.5)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg2, columns = c(Extraversion, 52),
lower = list(
continuous = 'smooth',
discrete = 'ratio',
combo ='box'
),
upper = list(
continuous = 'density'
),
mapping = aes(color = Gender)
)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg2, columns = c(Extraversion, 52),
lower = list(
continuous = 'smooth',
combo ='box'
),
upper = list(
continuous = 'density'
),
mapping = aes(color = Gender)
)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg2, columns = Extraversion,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
Extraversion <- 1:8
Agreeableness <- 9:17
Conscientiousness <- 18:27
Neuroticism <- 28:34
Openness <- 35:44
ggpairs(bfg, columns = Extraversion,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$Vote <- as.factor(bfg$Vote)
bfg$State < as.factor(bfg$State)
ggpairs(bfg, columns = 45:57,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$Vote <- as.factor(bfg$Vote)
bfg$State <- as.factor(bfg$State)
ggpairs(bfg, columns = 45:57,
lower = list(
continuous = 'smooth'
),
upper = list(
continuous = 'density'
)
)
library(lavaan)
library(GGally)
library(ggplot2)
library(corrplot)
bfg <- read.table( "bfg_numeric.csv", sep = "\t", header = TRUE)
bfg$Vote <- as.factor(bfg$Vote)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$State <- as.factor(bfg$State)
library(GGally)
library(corrplot)
bfg <- read.table( "bfg_numeric.csv", sep = "\t", header = TRUE)
bfg$Vote <- as.factor(bfg$Vote)
bfg$Gender <- as.factor(bfg$Gender)
bfg$Race <- as.factor(bfg$Race)
bfg$State <- as.factor(bfg$State)
library("dplyr")
library("tidyr")
library("ggplot2")
df_wide <- read.table("wells_addition_data.txt",
header = TRUE,
na.strings = ".")
df_wide
df_wide <- read.table("wells_addition_data.txt",
header = TRUE,
na.strings = ".")
df_wide
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- factor(period)
})
df_long
?gather
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
convert = TRUE,
3:6)
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
convert = TRUE,
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- factor(period)
})
df_long
colnames(df_wide)
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
convert = TRUE,
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- factor(period)
})
df_long
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
# id <- factor(id)
period <- as.integer(period)
})
df_long
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items") +
theme(legend.position = "none")
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items")
colnames(df_wide) <- c("id",  "sex", "0",  "3",  "6",  "9")
df_long <- gather(data = df_wide ,
key = "period",
value = "score",
3:6)
# change type of variables into factors
df_long  <- within(df_long, {
id <- factor(id)
period <- as.integer(period)
})
df_long
ggplot(data = df_long, aes(x = period , y = score, group = id)) +
geom_line(aes(colour = id), size = 0.2) +
facet_grid(. ~ sex) +
xlab("Follow up Periods") +
ylab("Number Correct") +
ggtitle("Data from Wells' study of learning on a power test of simple arithmetic items")
fit1 <- aov( score ~ period*sex + Error(id/period),
data = df_long)
summary(fit1)
library("dplyr")
library("tidyr")
library("ggplot2")
library("lme4")
demo1.aov <- lmer(score ~ period*sex +(1 |id), data = df_long)
coef(demo1.aov)
fixef(demo1.aov)
ranef(demo1.aov)
summary(demo1.aov)
print(demo1.aov )
Anova(demo1.aov,type="III")
demo1.aov <- lmer(score ~ period*sex +(1 |id), data = df_long)
coef(demo1.aov)
fixef(demo1.aov)
ranef(demo1.aov)
summary(demo1.aov)
print(demo1.aov )
anova(demo1.aov)
demo1.aov <- lmer(score ~ period*sex , data = df_long)
library("dplyr")
library("tidyr")
library("ggplot2")
library("nlme")
demo1.aov <- lme(score ~ period*sex +(1 |id), data = df_long)
demo1.aov <- lme(score ~ period+sex +(1 |id), data = df_long)
demo1.aov <- lme(score ~ period +(1 |id), data = df_long)
demo1.aov <- lme(score ~ period*sex, data = df_long)
demo1.aov <- lme(score ~ period, data = df_long)
wants <- c("car", "mvtnorm")
has   <- wants %in% rownames(installed.packages())
if(any(!has)) install.packages(wants[!has])
set.seed(123)
P     <- 3
Nj    <- c(15, 25, 20)
Sigma <- matrix(c(16,-2, -2,9), byrow=TRUE, ncol=2)
mu11  <- c(-4,  4)
mu21  <- c( 3,  3)
mu31  <- c( 1, -1)
library(mvtnorm)
Y11 <- round(rmvnorm(Nj[1], mean=mu11, sigma=Sigma))
Y21 <- round(rmvnorm(Nj[2], mean=mu21, sigma=Sigma))
Y31 <- round(rmvnorm(Nj[3], mean=mu31, sigma=Sigma))
dfMan1 <- data.frame(Y =rbind(Y11, Y21, Y31),
IV=factor(rep(1:P, Nj)))
View(Sigma)
View(Y11)
View(Y21)
View(Y31)
View(dfMan1)
manRes1 <- manova(cbind(Y.1, Y.2) ~ IV, data=dfMan1)
summary(manRes1, test="Wilks")
